:: WayStar by SYN-3r

@echo off

:: color variables
SET red=<Esc>[1;31m
SET black=<Esc>[1;30m
SET green=<Esc>[1;32m
SET yellow=<Esc>[1;33m
SET blue=<Esc>[1;34m
SET magenta=<Esc>[1;35m
SET cyan=<Esc>[1;36m
SET white=<Esc>[1;37m
SET blink=<Esc>[5m
SET normal=<Esc>[0m

echo "/-----------------------------------------------------------------------------\\"
echo "|                           %white% %blink%  ⭐%normal%  %cyan% WayStar by SYN-3r %white% %blink%  ⭐%normal%                            %normal% |"
echo "|                       %cyan% A Windows Enummeration Script                         %normal% |"
echo "|-----------------------------------------------------------------------------|"
echo "|  %magenta% , : | | %cyan% | |:  %green% ||  :     %magenta% ,  :  |  |+%cyan% |: | :%green%  : :|   .        %normal% ,%cyan%               . %normal% |"
echo "|      %magenta% , : | %cyan% :|  ||  %green% |:  :    %magenta% ,  |  | :%cyan% | : | : |%green% :   %cyan% |  %white% %blink%  .%normal%                     %magenta% : %normal% |"
echo "|         %magenta% %white% %blink%  .%normal% %magenta% ' ':  %cyan% ||  |:  %green% |  '%magenta%        , || %cyan% | : | %green% |: : |   .%normal%   ,           %normal% %white% %blink%  .%normal%    %magenta% :. %normal% |"
echo "|                %magenta% ,'  ||  %cyan% |  ' |   %normal% *%magenta%     , : | | %cyan% :| |%normal% *%green% |  :   %magenta% :               %cyan% :%green% | %normal% |"
echo "|        *    *       %magenta% ,  |  : %cyan% :  |  %green% . %magenta%      , ' :| | %cyan% :| . %green% : :         %normal% *%cyan%    :.%green% || %normal% |"
echo "|             %white% %blink%  .%normal% ,           %magenta%  | |  %cyan% |  %green% : .:|  %magenta%      , | |%cyan% | | : %green% |: |          | || %normal% |"
echo "|      '          %white% %blink%  .%normal%          %magenta% + ,  |  %green% :  .: . %magenta%         '| | %cyan% : :|%green%  :    %normal% %white% %blink%  .%normal%    %magenta% |:%cyan% | |%green% | %normal% |"
echo "|         %white% %blink%  .%normal%                  %white% %blink%  .%normal%     %magenta% , %cyan% *|  |%green% | : %normal%       ,%magenta%     | | %cyan% :| %green% | :      %magenta% |:%cyan% | %green% |  %normal% |"
echo "| %white% %blink%  .%normal%                 %white% %blink%  .%normal%           %white% %blink%  .%normal%         %magenta% || %green% |.: %normal% *%magenta%           | |%cyan% | : %green% :     %magenta% :|%cyan% ||%green% |   %normal% |"
echo "|        %white% %blink%  .%normal%             %white% %blink%  .%normal%    . *    %white% %blink%  .%normal%    %white% %blink%  .%normal%   %magenta% , |||.  %normal% +        +%magenta%  '| %cyan% ||%green% |  %white% %blink%  .%normal%   %magenta% ||%cyan% ,%green% |    %normal% |"
echo "|     %white% %blink%  .%normal%              *              %white% %blink%  .%normal%      %magenta% +:,|%green% | %magenta%             %white% %blink%  .%normal%  %magenta% ||%cyan% ||  %magenta% :%white% %blink%  .%normal% %magenta% |%cyan% |,%green% |     %normal% |"
echo "| +                      %white% %blink%  .%normal%                 %magenta% ..%magenta% |%cyan% |%normal% *%magenta%           . | :%cyan% ,|%green% |+ %magenta% |||%cyan% ,%green% |      %normal% |"
echo "|     %white% %blink%  .%normal%                          +      %magenta% : %cyan% ||%green% |,%magenta%         .| :| %cyan% | | %green% |.| %magenta% |%cyan% |%green% ,     %normal% %white% %blink%  .%normal%   %normal% |"
echo "|       *     +   '               +  %magenta% :|%green% | |, %magenta%     :.%cyan% +. ||%green%  || | %magenta% |:,%cyan% || %green% ,          %normal% |"
echo "|                            %white% %blink%  .%normal%       %magenta% .|%green% |, .%magenta%     ..|%cyan% | | %green% |: %cyan% ', ,| %magenta% | %cyan% |%green% ,  %normal% +         %normal% |"
echo "|  %white% %blink%  .%normal%        + +                      %magenta% ||  %magenta%       ||%cyan% |: %green% ,       %magenta% :%cyan% | %green% |               %normal% |"
echo "|              +         %white% %blink%  .%normal%       %white% %blink%  .%normal%     %magenta% | %green% .  %magenta%     ,|%cyan% ||%green% .:      %magenta% .%cyan% |%green% |    %normal% %white% %blink%  .%normal%       %white% %blink%  .%normal%     ,%normal% |"
echo "|          '                           %magenta% ,|%green% . %magenta%   %white% %blink%  .%normal% %magenta%   ,:%cyan% |%green% ||   %normal% + %magenta% |%cyan% |%green% '     %normal% ,           %normal% |"
echo "|  %black% __    %normal% +      *                         %green% ,'%magenta%        ,%cyan% '%green% |.    %magenta% ,%green% :                 %normal% |"
echo "|%black% ^,  ,---^^^----....____,..^---,^,,----.,.___          %cyan% ,%green% .    %cyan% ,%green% .  .    %black% ____,.,-%normal% |"
echo "|%black% ::::___,---^^,---^   ^  ^ ^::::::::^   ::::^^^---,..___ __,..---^^::::::::   %normal% |"
echo "|%black% --^ ::::::  :^::::::::::::::::::::: ^  ::::::::::::::::: :::  ,,--..,__ :::  %normal% |"
echo "\-----------------------------------------------------------------------------/"
echo.
echo.

:: BEGINNING OF SCRIPT
echo %cyan% ..................................................... %normal%
echo %green%             SITUATIONAL AWARENESS %normal
echo %cyan% ..................................................... %normal%
echo .
echo %cyan% Current user: %normal%
echo %USERNAME%
echo.

echo %cyan% Does powershell exist? %normal%
:: check to see if powershell exists
REG QUERY "HKLM\SOFTWARE\Microsoft\PowerShell\1\PowerShellEngine" /v PowerShellVersion 
echo.

echo %cyan% Date of last reboot: %normal%
dir /a c:\pagefile.sys
echo.

echo %cyan% ..................................................... %normal%
echo %green%                    OS INFORMATION %normal
echo %cyan% ..................................................... %normal%
echo .

echo %green% Windows  Product Name: %normal%
HKLM\Software\Microsoft\Windows NT\CurrentVersion /v ProductName
echo %green% Windows  Install Date: %normal%
HKLM\Software\Microsoft\Windows NT\CurrentVersion /v InstallDate
echo %green% Windows  Registered Owner: %normal%
HKLM\Software\Microsoft\Windows NT\CurrentVersion /v RegisteredOwner
echo %green% Windows  System Root: %normal%
HKLM\Software\Microsoft\Windows NT\CurrentVersion /v SystemRoot
echo.

echo %cyan% Version ands system info: %normal%
ver
echo.
systeminfo
echo.
 



echo %cyan% ..................................................... %normal%
echo %green%            USERS, ACCOUNTS, AND GROUPS %normal
echo %cyan% ..................................................... %normal%
echo .

:: display users
%cyan% Users: %normal%
net users 

:: display accounts
%cyan% Accounts: %normal%
net accounts

:: display groups
%cyan% Groups: %normal%
net localgroup

:: find administrators
%cyan% Admins: %normal%
net localgroup administrators
echo.

echo %cyan% ..................................................... %normal%
echo %green%                   PASSWORDS %normal
echo %cyan% ..................................................... %normal%
echo .

echo %cyan% HKLM and HKCU: %normal%
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon" 2>nul | findstr "DefaultUserName DefaultDomainName DefaultPassword" 
reg query HKLM /f password /t REG_SZ /s /k
reg query HKCU /f password /t REG_SZ /s /k
reg query "HKCU\Software\ORL\WinVNC3\Password" 
reg query "HKLM\SYSTEM\Current\ControlSet\Services\SNMP" 
reg query "HKCU\Software\SimonTatham\PuTTY\Sessions" 

:: searches passwords for cleartext paswswords
%cyan% Cleartext Passwords: %normal%
dir /s /b *pass* *cred* *vnc* *.config*

:: search password registry for password
reg query HKLM if /fd password /t REG_SZ /s
echo.


echo %cyan% ..................................................... %normal%
echo %green%               SECURITY DETECTION %normal
echo %cyan% ..................................................... %normal%
echo .
:: antivirus detection 
WMIC /Node:localhost /Namespace:\\root\SecurityCenter2 Path AntiVirusProduct Get displayName
echo.


:::::::::::::::::::::::::::::::::::::::::::::::
::             COMMANDS TO USE               ::
:::::::::::::::::::::::::::::::::::::::::::::::

:: display all processes
wmic process get procesid,commandline

:: display logical drives
wmic logicaldisk get description,name


:: Looks fro commands run at startup
wmic startup get caption,command

:: Looks for scheduled tasks
schtasks /query /fo LIST /v | findstr "TaskName Author: Run: User:"

:: Look for SAM or SYSTEM files
dir %SYSTEMROOT%\repair\SAM 2>nul
dir %SYSTEMROOT%\System32\config\RegBack\SAM 2>nul
dir %SYSTEMROOT%\System32\config\SAM 2>nul
dir %SYSTEMROOT%\repair\system 2>nul
dir %SYSTEMROOT%\System32\config\SYSTEM 2>nul
dir %SYSTEMROOT%\System32\config\RegBack\system 2>nul
dir /a /b /s SAM.b*

:: vnc, kdbx, or rdp files
dir /a /s /b *.kdbx *vnc.ini *.rdp


